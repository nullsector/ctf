# PAN LabyREnth 2017: Binary Level 1 - BBzFirstMalware

BBz First Malware make u cry evry time

## Write-up
We're given a 32-bit PE binary named MyFirstMalware.exe and other files named config.jpg and notdroids.jpg. The JPG files are not JPG file but are some sort of encrypted data.
![notdroids.jpg contents](notdroidscontents.JPG)
![config.jpg contents](configjpgcontents.JPG)

Initially running the binary doesn't give any output.

### Solution
Now time to debug/reverse it. I used Immunity Debugger, IDA Pro, procmon for this purpose. Right after the entry point it creates a mutex named "glhf" after which it sets a call to sleep with a very high value. I patched what is pushed to the sleep function to 0.
![here](malwarestart.JPG)
![here](sleepafter.JPG)

Continuing on, there are some hints as to where the binary expects the JPG files.
![here](hints.JPG)

I place those files there and restart the debugging.

I then run into some anti-debugging technique using the rdtsc call which I use the hidedebug plugin to overcome.
![here](rdtsc.JPG)



